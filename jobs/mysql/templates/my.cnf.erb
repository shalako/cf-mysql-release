<%
base_folder = '/var/vcap/sys/run/mysql'

max_user_connections = properties.services[0].plans[0].max_user_connections rescue nil
max_connections = properties.services[0].plans[0].max_connections rescue nil
%>

[client]
port      = <%= properties.mysql.port %>
socket		= <%= "#{base_folder}/mysqld.sock" %>

[mysqld_safe]
nice      = 0

[mysqld]
collation_server        = utf8_unicode_ci
character_set_server    = utf8
user		= vcap
socket		= <%= "#{base_folder}/mysqld.sock" %>
port     	= <%= properties.mysql.port %>
basedir		= /var/vcap/packages/mysql
datadir		= /var/vcap/store/mysql
language	= /var/vcap/packages/mysql/share/english
pid-file  = /var/vcap/sys/run/mysql/mysqld.pid
log-error = /var/vcap/sys/log/mysql/mysqld.err.log
init-file = /var/vcap/jobs/mysql/config/mysql_init
skip-external-locking
innodb_file_per_table

<% if !max_user_connections.nil? %>
max_user_connections = <%= max_user_connections %>
<% end %>

<% if max_connections %>
max_connections = <%= max_connections %>
<% end %>

[mysqldump]
quick
quote-names
max_allowed_packet	= 16M

[mysql]

[isamchk]
key_buffer		= 16M
