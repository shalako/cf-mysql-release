This file is only used to validate the manifest properties.
It should be ignored after deployment.

<%
   def is_number(text)
     true if Integer(text.to_s) rescue false
   end

   begin
     services = properties.services
     raise "Property 'services' must be an array of one service" unless services.is_a?(Array) && services.length == 1

     service = services[0]

     plans = service.plans
     if plans
       raise "Service property 'plans' must be empty or an array of one plan" unless plans.is_a?(Array) && plans.length == 1

       plan = plans[0]
       raise "Plan must have integer property 'max_user_connections'" unless plan.max_user_connections && is_number(plan.max_user_connections)
     end

   rescue => e
     text = <<-END
services:
- id: cf-mysql-1
  name: cf-mysql
  description: Cloud Foundry MySQL
  bindable: true
  plans:
  - id: cf-mysql-plan-1
    name: free
    description: Free Trial
    max_storage_mb: 5
    max_user_connections: 20
END

     raise e.message + "\n\nExample:\n\n" + text
   end
%>
